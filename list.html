<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="robots" content="noindex, nofollow">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>体験談一覧</title>

<style>
body{font-family:sans-serif;background:#f7f7f7;padding:20px;}
.container{max-width:900px;margin:auto;}
.post{background:white;padding:18px;border-radius:10px;margin-bottom:20px;}
.meta{font-size:13px;color:#555;margin-bottom:6px;}
.section-title{font-weight:bold;margin-top:10px;}
textarea{width:100%;height:80px;margin-top:5px;}
button{margin-top:8px;padding:6px 12px;cursor:pointer;}
.searchbox{
  width:100%;
  padding:12px;
  font-size:16px;
  margin-bottom:20px;
  border-radius:10px;
  border:1px solid #ccc;
}
.star{
  font-size:20px;
  margin:6px 0;
}
</style>
</head>

<body>
<div class="container">

<a href="index.html">←トップ</a>
<h1>体験談一覧</h1>

<input 
  id="search"
  class="searchbox"
  placeholder="施術・クリニック・キーワード検索（例：埋没 湘南 クマ）"
  oninput="render()"
/>

<div id="list"></div>
</div>

<script>
const STORAGE_KEY="reviews_v1";

function loadAll(){
 return JSON.parse(localStorage.getItem(STORAGE_KEY)||"[]");
}
function saveAll(arr){
 localStorage.setItem(STORAGE_KEY,JSON.stringify(arr));
}

function deletePost(id){
 let all=loadAll();
 all=all.filter(p=>p.id!==id);
 saveAll(all);
 render();
}

function editPost(id){
 const all=loadAll();
 const p=all.find(x=>x.id===id);
 if(!p)return;

 const good=prompt("良かった点",p.good);
 if(good===null)return;

 const bad=prompt("不安・不満",p.bad);
 if(bad===null)return;

 const advice=prompt("注意点",p.advice);
 if(advice===null)return;

 p.good=good;
 p.bad=bad;
 p.advice=advice;

 saveAll(all);
 render();
}

function render(){
 const list=document.getElementById("list");
 const keyword=document.getElementById("search").value.toLowerCase();
 let all=loadAll();

 // 検索フィルター
 if(keyword){
  all=all.filter(p=>
   (p.procedure+p.clinic+p.good+p.bad+p.advice)
   .toLowerCase()
   .includes(keyword)
  );
 }

 if(all.length===0){
  list.innerHTML="<p>該当する投稿がありません</p>";
  return;
 }

 list.innerHTML=all.map(p=>`
  <div class="post">
   <div class="meta">
   ${p.procedure}｜${p.region}｜${p.clinic}
   </div>

   <div class="star">満足度：${p.rating}</div>

   <div class="section-title">良かった点</div>
   <div>${p.good}</div>

   <div class="section-title">不安・不満</div>
   <div>${p.bad}</div>

   <div class="section-title">注意点</div>
   <div>${p.advice}</div>

   <button onclick="editPost('${p.id}')">編集</button>
   <button onclick="deletePost('${p.id}')">削除</button>
  </div>
 `).join("");
}

render();
</script>
</body>
</html>


